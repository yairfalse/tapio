version: 1
description: "Example filter configuration for testing"

# Deny filters - drop matching events
deny_filters:
  - name: "localhost_traffic"
    type: "network"
    description: "Filter out localhost traffic"
    enabled: true
    conditions:
      source_ip: "127.0.0.1"

  - name: "healthcheck_endpoints"
    type: "http"
    description: "Filter out health check endpoints"
    enabled: true
    conditions:
      url_pattern: "^/(health|ready|metrics|healthz|readyz)$"

  - name: "noisy_dns"
    type: "dns"
    description: "Filter out noisy DNS queries"
    enabled: true
    conditions:
      domain_pattern: "\\.cluster\\.local$"

  - name: "debug_logs"
    type: "severity"
    enabled: false  # Can be toggled
    description: "Filter out debug level events"
    conditions:
      min_severity: "info"  # Drop everything below INFO

# Allow filters - only process matching events
allow_filters:
  - name: "important_syscalls"
    type: "event_type"
    enabled: false
    description: "Only track important syscall events"
    conditions:
      types:
        - "kernel.syscall"
        - "kernel.network"
        - "kernel.filesystem"