# gRPC-Gateway configuration
# This file configures how the gRPC-Gateway reverse proxy works

# HTTP API Configuration
http:
  rules:
    # Allow all origins for CORS (configure properly for production)
    - selector: "*"
      allow_cors: true
      cors:
        allow_origins: ["*"]
        allow_methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
        allow_headers: ["Content-Type", "Authorization", "X-Request-ID"]
        expose_headers: ["X-Request-ID", "X-Trace-ID"]
        max_age: 3600

# OpenAPI Configuration
openapi_config:
  info:
    title: "Tapio Observability Platform API"
    version: "1.0.0"
    description: |
      Tapio provides enterprise-grade observability with semantic correlation.
      
      ## Features
      - Real-time event streaming with OTEL context
      - AI-powered semantic correlation
      - Multi-dimensional root cause analysis
      - Predictive analytics and business impact assessment
      
      ## Authentication
      API keys or JWT tokens in Authorization header
      
      ## Rate Limiting
      - 10,000 requests per minute per API key
      - 165,000 events per second for streaming
    
    contact:
      name: "Tapio Support"
      email: "support@tapio.io"
      url: "https://tapio.io/support"
    
    license:
      name: "Apache 2.0"
      url: "https://www.apache.org/licenses/LICENSE-2.0"
  
  external_docs:
    description: "Full Tapio Documentation"
    url: "https://docs.tapio.io"
  
  schemes:
    - https
    - http
  
  consumes:
    - application/json
    - application/grpc
    - application/grpc+proto
    - application/grpc+json
  
  produces:
    - application/json
    - application/grpc
    - application/grpc+proto
    - application/grpc+json
  
  security_definitions:
    api_key:
      type: "apiKey"
      name: "X-API-Key"
      in: "header"
    
    bearer_auth:
      type: "apiKey"
      name: "Authorization"
      in: "header"
      description: "Bearer token authentication"
  
  security:
    - api_key: []
    - bearer_auth: []
  
  tags:
    - name: "Events"
      description: "Event ingestion and querying"
    - name: "Correlations"
      description: "Correlation and semantic analysis"
    - name: "Collectors"
      description: "Collector management"
    - name: "Metrics"
      description: "System metrics and observability"
    - name: "Health"
      description: "Service health monitoring"