version: "1.0"
patterns:
  - id: pod-eviction-storm
    name: Pod Eviction Storm
    category: resource
    description: Multiple pods being evicted due to resource pressure
    enabled: true
    tags: ["eviction", "resource", "storm"]
    indicators:
      - type: frequency
        field: "reason:Evicted"
        threshold: 5
        time_window: 1m
      - type: event
        field: message
        condition: contains
        value: disk pressure
    impact:
      severity: critical
      scope: node
      user_impact: true
      performance_risk: true
    correlations:
      - node-resource-exhaustion

  - id: node-resource-exhaustion
    name: Node Resource Exhaustion
    category: resource
    description: Node running out of resources
    enabled: true
    tags: ["node", "resource", "exhaustion"]
    indicators:
      - type: state
        field: node.status.conditions.DiskPressure
        condition: equals
        value: "True"
      - type: state
        field: node.status.conditions.MemoryPressure
        condition: equals
        value: "True"
    impact:
      severity: critical
      scope: node
      user_impact: true
    correlations:
      - pod-eviction-storm

  - id: pvc-mount-failure
    name: PersistentVolume Mount Failure
    category: resource
    description: Pods unable to mount persistent volumes
    enabled: true
    tags: ["storage", "pvc", "mount"]
    indicators:
      - type: event
        field: reason
        condition: equals
        value: FailedMount
      - type: event
        field: message
        condition: contains
        value: volume
    impact:
      severity: high
      scope: pod
      user_impact: true
      data_risk: true
    correlations: []